/*
// Definition for a Node.
class Node {
public:
    int val;
    Node* next;
    Node* random;

    Node(int _val) {
        val = _val;
        next = NULL;
        random = NULL;
    }
};
*/

class Solution {
public:
    Node* copyRandomList(Node* head) {
        if(head==NULL) return head;
        Node* head1 = new Node(head->val);
        Node* temp1 = head1;
        Node* temp = head->next;
        while (temp != NULL) {
            Node* N = new Node(temp->val);
            temp1->next = N;
            temp1 = temp1->next;
            temp = temp->next;
        } // ise mere pass sare next walle pointers new list me aagye
        // ab bas random ka dhekna h
        // ab me ek mapping create krleta hu uske bina random jodna mushkil h
        unordered_map<Node* , Node*>mp;
        Node* tempp = head;
        Node* tempp1 = head1;
        while(tempp!=NULL){
            mp[tempp] = tempp1;
            tempp = tempp->next;
            tempp1 = tempp1->next;
        }
        // ab ek map bnhgya 
        // bas ab random ka krna
        Node* temppp = head;
        Node* temppp1 = head1;
        while(temppp!=NULL){
            if(temppp->random !=NULL){
                temppp1->random = mp[temppp->random];
            }
            temppp = temppp->next;
            temppp1 = temppp1->next;
        }
        return head1;
    }
};